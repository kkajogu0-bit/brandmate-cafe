<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BrandMate Pro â€” ë‹¨ì¼íŒŒì¼ ì•±</title>
<style>
  :root{--bg:#0d1117;--card:#161b22;--muted:#9fb0c0;--text:#e6edf3;--acc:#1f6feb;--ok:#34d399;--err:#ef4444}
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--text);font:14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, sans-serif}
  .wrap{max-width:1100px;margin:0 auto;padding:20px}
  .nav{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-bottom:14px}
  .nav .tabs{display:flex;gap:6px;flex-wrap:wrap}
  .btn{cursor:pointer;border:1px solid #30363d;background:#21262d;color:#fff;padding:10px 14px;border-radius:10px}
  .btn.primary{background:linear-gradient(180deg,#2563eb,#1d4ed8);border:none}
  .btn.ghost{background:transparent;border-color:#30363d}
  .card{background:var(--card);border:1px solid #30363d;border-radius:14px;padding:18px}
  .grid{display:grid;gap:12px}
  .g2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  label{display:block;color:var(--muted);font-size:12px;margin:2px 0 6px}
  input,select,textarea{width:100%;background:#0d1117;border:1px solid #30363d;color:#e6edf3;border-radius:10px;padding:10px}
  textarea{resize:vertical;min-height:120px}
  .muted{color:var(--muted)}
  .hidden{display:none}
  .ok{color:var(--ok)} .err{color:var(--err)}
  /* mini dashboard */
  .dash-metric{display:grid;grid-template-columns:1fr auto;align-items:center;padding:12px;border:1px solid #30363d;border-radius:10px}
  .pill{border:1px solid #30363d;border-radius:999px;padding:4px 10px;display:inline-block;font-size:12px}
  /* banner preview */
  #preview{width:100%;background:#0b1320;border-radius:10px}
  @media (max-width:780px){.g2,.g3{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="wrap">

  <!-- ìƒë‹¨ ë‚´ë¹„ê²Œì´ì…˜ -->
  <div class="nav">
    <div class="tabs">
      <button class="btn" data-tab="auth">ë¡œê·¸ì¸</button>
      <button class="btn" data-tab="dash">ëŒ€ì‹œë³´ë“œ</button>
      <button class="btn" data-tab="tools">ë„êµ¬</button>
      <button class="btn" data-tab="owner">ì˜¤ë„ˆ ë„êµ¬</button>
    </div>
    <div class="row">
      <span id="planBadge" class="pill">PLAN: LITE</span>
      <button id="logoutBtn" class="btn ghost hidden">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </div>

  <!-- ë¡œê·¸ì¸/íšŒì›ê°€ì… -->
  <section id="tab-auth" class="card">
    <h2>ğŸ”’ BrandMate Pro â€” ë¡œê·¸ì¸</h2>
    <p class="muted">ë°ëª¨ ëª¨ë“œë¡œ ëª¨ë“  ê¸°ëŠ¥ ì²´í—˜ ê°€ëŠ¥. ì •ì‹ ì‚¬ìš©ì€ ê²°ì œ ë˜ëŠ” ë¼ì´ì„ ìŠ¤ í•„ìš”.</p>
    <div class="grid g2">
      <div>
        <label>ì´ë©”ì¼</label>
        <input id="email" type="email" placeholder="you@example.com">
      </div>
      <div>
        <label>ë¹„ë°€ë²ˆí˜¸</label>
        <input id="password" type="password" placeholder="8ì ì´ìƒ">
      </div>
    </div>
    <div class="row" style="margin-top:8px">
      <button id="loginBtn" class="btn primary">ë¡œê·¸ì¸</button>
      <button id="signupBtn" class="btn">íšŒì›ê°€ì…</button>
      <button id="demoBtn" class="btn ghost">ë°ëª¨ ëª¨ë“œ</button>
    </div>
    <div id="authMsg" class="muted" style="margin-top:6px"></div>

    <div class="row" style="margin-top:14px">
      <div class="card" style="flex:1">
        <h3>ğŸ’³ ê²°ì œ (Stripe Payment Link)</h3>
        <p class="muted">ê²°ì œ í›„ â€˜ì˜¤ë„ˆ ë„êµ¬â€™ì—ì„œ ë¼ì´ì„ ìŠ¤ í‚¤ë¥¼ ë°œê¸‰/ë“±ë¡í•´ ì£¼ì„¸ìš”.</p>
        <div class="row">
          <button id="payBtn" class="btn primary">ê²°ì œ í˜ì´ì§€ ì—´ê¸°</button>
          <a id="payLink" class="btn ghost" href="#" target="_blank" rel="noopener">ë§í¬ ìƒˆì°½</a>
        </div>
      </div>
      <div class="card" style="flex:1">
        <h3>ğŸ”‘ ë¼ì´ì„ ìŠ¤ ì ê¸ˆ í•´ì œ</h3>
        <div class="grid g2">
          <div><label>ì´ë©”ì¼</label><input id="licEmail" placeholder="ê²°ì œ/ë“±ë¡ ì´ë©”ì¼"></div>
          <div><label>ë¼ì´ì„ ìŠ¤ í‚¤</label><input id="licKey" placeholder="XXXX-XXXX-XXXX"></div>
        </div>
        <div class="row" style="margin-top:8px">
          <button id="unlockBtn" class="btn">ì ê¸ˆ í•´ì œ</button>
        </div>
        <div id="licMsg" class="muted" style="margin-top:6px"></div>
      </div>
    </div>
  </section>

  <!-- ëŒ€ì‹œë³´ë“œ -->
  <section id="tab-dash" class="card hidden">
    <h2>ğŸ“Š ëŒ€ì‹œë³´ë“œ</h2>
    <div class="grid g3" style="margin-top:10px">
      <div class="dash-metric"><div>ë¡œê·¸ì¸ ìƒíƒœ</div><div id="who" class="pill">ê²ŒìŠ¤íŠ¸</div></div>
      <div class="dash-metric"><div>í”Œëœ</div><div id="plan" class="pill">LITE</div></div>
      <div class="dash-metric"><div>ë§Œë£Œì¼</div><div id="expiry" class="pill">â€”</div></div>
    </div>
    <div class="row" style="margin-top:14px">
      <button class="btn primary" data-tab-jump="tools">ì§€ê¸ˆ ë°”ë¡œ ë°°ë„ˆ ë§Œë“¤ê¸°</button>
      <button id="toPayment" class="btn">ê²°ì œ/ì—…ê·¸ë ˆì´ë“œ</button>
    </div>
  </section>

  <!-- ë„êµ¬(ê°„ë‹¨ ë°°ë„ˆ ìƒì„±ê¸° + ìº¡ì…˜) -->
  <section id="tab-tools" class="card hidden">
    <h2>ğŸ› ï¸ ë„êµ¬</h2>
    <div class="grid g2" style="margin-top:10px">
      <div>
        <h3>ë°°ë„ˆ</h3>
        <label>ì œëª©</label><input id="bnTitle" placeholder="ì˜¤ëŠ˜ì˜ ì‹œê·¸ë‹ˆì²˜ 20% OFF">
        <label>ë³´ì¡° ë¬¸êµ¬</label><input id="bnSub" placeholder="í•™ìƒì¦ ì œì‹œ 1,000ì›â†“ Â· ì´ë²ˆ ì£¼ í•œì •">
        <div class="grid g3">
          <div><label>ê¸°ë³¸ìƒ‰</label><input id="c1" type="color" value="#2663eb"></div>
          <div><label>ë³´ì¡°ìƒ‰</label><input id="c2" type="color" value="#14b8a6"></div>
          <div><label>í…ìŠ¤íŠ¸ìƒ‰</label><input id="tx" type="color" value="#ffffff"></div>
        </div>
        <div class="row" style="margin-top:8px">
          <button id="genBanner" class="btn primary">ë¯¸ë¦¬ë³´ê¸°</button>
          <button id="saveBanner" class="btn">PNG ì €ì¥</button>
        </div>
        <p id="bnNote" class="muted" style="margin-top:6px"></p>
      </div>
      <div>
        <canvas id="preview" width="1080" height="1080"></canvas>
      </div>
    </div>

    <div class="grid g2" style="margin-top:18px">
      <div>
        <h3>ìº¡ì…˜</h3>
        <label>í‚¤ì›Œë“œ(ì‰¼í‘œ)</label><input id="kw" placeholder="ì¹´í˜, ì‹œí—˜ê¸°ê°„, ì§‘ì¤‘, í• ì¸">
        <label>í†¤</label>
        <select id="tone">
          <option value="friendly">ì¹œê·¼í•¨</option>
          <option value="minimal">ë¯¸ë‹ˆë©€</option>
          <option value="energetic">ì—ë„ˆì§€</option>
        </select>
        <div class="row" style="margin-top:8px">
          <button id="genCaps" class="btn">5ê°œ ìƒì„±</button>
          <button id="copyCaps" class="btn ghost">ë³µì‚¬</button>
        </div>
      </div>
      <div>
        <label>ê²°ê³¼</label>
        <textarea id="capsOut" placeholder="ì—¬ê¸°ì— ìº¡ì…˜ì´ ìƒì„±ë©ë‹ˆë‹¤."></textarea>
      </div>
    </div>
  </section>

  <!-- ì˜¤ë„ˆ ë„êµ¬(ë¼ì´ì„ ìŠ¤ í•´ì‹œ ìƒì„±ê¸°) -->
  <section id="tab-owner" class="card hidden">
    <h2>ğŸ—ï¸ ì˜¤ë„ˆ ë„êµ¬ â€” ë¼ì´ì„ ìŠ¤ í•´ì‹œ ìƒì„±</h2>
    <p class="muted">ì´ë©”ì¼ + í‚¤ + SALT â†’ SHA-256 í•´ì‹œë¥¼ ë§Œë“¤ì–´ <b>licenses.json</b>ì— ì¶”ê°€í•˜ì„¸ìš”.</p>
    <div class="grid g3">
      <div><label>ì´ë©”ì¼</label><input id="ownEmail" placeholder="customer@example.com"></div>
      <div><label>ë¼ì´ì„ ìŠ¤ í‚¤</label><input id="ownKey" placeholder="ABCD-EFGH-IJKL"></div>
      <div><label>í”Œëœ</label><select id="ownPlan"><option>pro</option><option>lite</option></select></div>
    </div>
    <div class="grid g3">
      <div><label>ë§Œë£Œì¼(ì„ íƒ)</label><input id="ownExp" placeholder="YYYY-MM-DD"></div>
      <div><label>SALT (ì•±ê³¼ ë™ì¼)</label><input id="ownSalt" placeholder="SALT" /></div>
      <div class="row" style="align-items:end"><button id="makeHash" class="btn primary">í•´ì‹œ ìƒì„±</button></div>
    </div>
    <pre id="hashOut" class="card" style="margin-top:10px;white-space:pre-wrap"></pre>
    <p class="muted" style="margin-top:6px">ìƒì„±ëœ JSON ê°ì²´ë¥¼ GitHubì˜ <b>licenses.json</b> ë°°ì—´ì— ì¶”ê°€ í›„ ì»¤ë°‹í•˜ì„¸ìš”.</p>
  </section>

</div>

<script type="module">
// ============== TODO: ì„¤ì • 3ê³³ ìˆ˜ì • ==============
// 1) Stripe Payment Link(í…ŒìŠ¤íŠ¸) â€” Stripe ëŒ€ì‹œë³´ë“œì—ì„œ ë§Œë“  ê²°ì œ ë§í¬ë¡œ êµì²´
const STRIPE_LINK = "https://buy.stripe.com/test_example_link";

// 2) Firebase ì„¤ì • â€” ë³¸ì¸ í”„ë¡œì íŠ¸ ê°’ìœ¼ë¡œ êµì²´
const firebaseConfig = {
  apiKey: "YOUR_FIREBASE_API_KEY",
  authDomain: "YOUR_FIREBASE_AUTH_DOMAIN",
  projectId: "YOUR_FIREBASE_PROJECT_ID",
  appId: "YOUR_FIREBASE_APP_ID"
};

// 3) ë¼ì´ì„ ìŠ¤ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ìœ„ì¹˜ + SALT â€” GitHub raw JSON ì£¼ì†Œ & ì„ì˜ SALT
const LICENSES_URL = "https://raw.githubusercontent.com/<your-id>/<your-repo>/main/licenses.json";
const SALT = "CHANGE_ME_SALT_2025";
// =================================================

// â”€â”€â”€ ê³µí†µ ë„ìš°ë¯¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const $ = (q)=>document.querySelector(q);
const $$ = (q)=>document.querySelectorAll(q);
const setTxt=(el,v)=>el.textContent=v;
const show=(id)=>document.getElementById(id).classList.remove('hidden');
const hide=(id)=>document.getElementById(id).classList.add('hidden');

async function sha256(s){
  const b=new TextEncoder().encode(s);
  const h=await crypto.subtle.digest("SHA-256",b);
  return Array.from(new Uint8Array(h)).map(x=>x.toString(16).padStart(2,'0')).join('');
}
function fmt(d){return d.toISOString().slice(0,10);}

// â”€â”€â”€ íƒ­ ì „í™˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function activate(tab){
  ["auth","dash","tools","owner"].forEach(t=>{
    document.getElementById("tab-"+t).classList.toggle("hidden",t!==tab);
  });
}
$$('.nav .btn[data-tab]').forEach(b=>b.addEventListener('click',()=>activate(b.dataset.tab)));
$$('[data-tab-jump]').forEach(b=>b.addEventListener('click',()=>activate(b.dataset.tabJump)));
activate('auth'); // ì´ˆê¸°

// â”€â”€â”€ Stripe ë§í¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
$("#payBtn").addEventListener("click", ()=>window.open(STRIPE_LINK,"_blank"));
$("#payLink").href = STRIPE_LINK;
$("#toPayment").addEventListener("click", ()=>{activate('auth'); window.scrollTo({top:0,behavior:'smooth'})});

// â”€â”€â”€ Firebase Auth â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

$("#loginBtn").addEventListener("click", async ()=>{
  $("#authMsg").textContent = "ë¡œê·¸ì¸ ì¤‘...";
  try{
    const u = await signInWithEmailAndPassword(auth, $("#email").value, $("#password").value);
    $("#authMsg").textContent = "ë¡œê·¸ì¸ ì„±ê³µ!";
  }catch(e){ $("#authMsg").textContent = e.message; }
});

$("#signupBtn").addEventListener("click", async ()=>{
  $("#authMsg").textContent = "íšŒì›ê°€ì… ì¤‘...";
  try{
    const u = await createUserWithEmailAndPassword(auth, $("#email").value, $("#password").value);
    $("#authMsg").textContent = "íšŒì›ê°€ì… ì™„ë£Œ!";
  }catch(e){ $("#authMsg").textContent = e.message; }
});

$("#demoBtn").addEventListener("click", ()=>{
  localStorage.setItem("bm_plan","pro");
  localStorage.setItem("bm_until","2099-12-31");
  updatePlanUI();
  activate('dash');
});

$("#logoutBtn").addEventListener("click", ()=>signOut(auth));

onAuthStateChanged(auth, (user)=>{
  if(user){
    setTxt($("#who"), user.email);
    $("#logoutBtn").classList.remove("hidden");
    activate('dash');
  }else{
    setTxt($("#who"), "ê²ŒìŠ¤íŠ¸");
    $("#logoutBtn").classList.add("hidden");
  }
  updatePlanUI();
});

// â”€â”€â”€ ë¼ì´ì„ ìŠ¤ ì²´í¬(í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ JSON) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function fetchLicenses(){
  const r = await fetch(LICENSES_URL, {cache:"no-store"});
  if(!r.ok) throw new Error("licenses.jsonì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŒ");
  return r.json();
}
async function checkLicense(email,key){
  try{
    const list = await fetchLicenses();
    const digest = await sha256(`${email}:${key}:${SALT}`);
    const today = fmt(new Date());
    const rec = list.find(x => x.hash===digest && (!x.expires||x.expires>=today));
    return rec || null;
  }catch(e){ return null }
}
$("#unlockBtn").addEventListener("click", async ()=>{
  $("#licMsg").textContent = "ê²€ì¦ ì¤‘...";
  const rec = await checkLicense($("#licEmail").value.trim(), $("#licKey").value.trim());
  if(rec){
    localStorage.setItem("bm_plan", (rec.plan||"pro"));
    localStorage.setItem("bm_until", (rec.expires||"â€”"));
    $("#licMsg").innerHTML = `<span class="ok">ì¸ì¦ ì„±ê³µ</span> â€” í”Œëœ: ${(rec.plan||"pro").toUpperCase()}${rec.expires?` Â· ë§Œë£Œ ${rec.expires}`:''}`;
    updatePlanUI(); activate('dash');
  }else{
    $("#licMsg").innerHTML = `<span class="err">ì¸ì¦ ì‹¤íŒ¨</span> â€” ì´ë©”ì¼/í‚¤ ë˜ëŠ” ë§Œë£Œ í™•ì¸`;
  }
});

function updatePlanUI(){
  const plan = localStorage.getItem("bm_plan") || "lite";
  const until = localStorage.getItem("bm_until") || "â€”";
  $("#plan").textContent = plan.toUpperCase();
  $("#planBadge").textContent = `PLAN: ${plan.toUpperCase()}`;
  $("#expiry").textContent = until;
}

// â”€â”€â”€ ì˜¤ë„ˆ ë„êµ¬: í•´ì‹œ ìƒì„±ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
$("#makeHash").addEventListener("click", async ()=>{
  const em = $("#ownEmail").value.trim();
  const key = $("#ownKey").value.trim();
  const salt = $("#ownSalt").value.trim() || SALT;
  if(!em || !key){ $("#hashOut").textContent = "ì´ë©”ì¼/í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”"; return; }
  const digest = await sha256(`${em}:${key}:${salt}`);
  const obj = {hash:digest, plan: $("#ownPlan").value, ...( $("#ownExp").value ? {expires:$("#ownExp").value} : {} )};
  $("#hashOut").textContent = JSON.stringify(obj, null, 2);
});

// â”€â”€â”€ ë°°ë„ˆ ìƒì„±(ê°„ë‹¨ ìº”ë²„ìŠ¤) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const cv = document.getElementById('preview');
const ctx = cv.getContext('2d');

function drawBanner(){
  const W=cv.width, H=cv.height;
  const c1=$("#c1").value, c2=$("#c2").value, tx=$("#tx").value;
  const title=$("#bnTitle").value||"ì˜¤ëŠ˜ì˜ ì‹œê·¸ë‹ˆì²˜ 20% OFF";
  const sub=$("#bnSub").value||"í•™ìƒì¦ ì œì‹œ 1,000ì›â†“ Â· ì´ë²ˆ ì£¼ í•œì •";

  // ë°°ê²½ ê·¸ë¼ë””ì–¸íŠ¸
  const g=ctx.createLinearGradient(0,0,W,H); g.addColorStop(0,c1); g.addColorStop(1,c2);
  ctx.fillStyle=g; ctx.fillRect(0,0,W,H);

  // ì‚´ì§ íŒ¨í„´
  ctx.globalAlpha=0.07; ctx.fillStyle="#fff";
  for(let i=0;i<6;i++){ ctx.beginPath(); ctx.arc(Math.random()*W,Math.random()*H,80+Math.random()*120,0,Math.PI*2); ctx.fill(); }
  ctx.globalAlpha=1;

  // í…ìŠ¤íŠ¸
  ctx.fillStyle=tx;
  ctx.font=`800 96px Inter, Pretendard, Noto Sans KR, sans-serif`;
  ctx.fillText(title, 80, 520, W-160);
  ctx.font=`500 44px Inter, Pretendard, Noto Sans KR, sans-serif`;
  ctx.fillText(sub, 80, 620, W-160);

  $("#bnNote").textContent = "ë¯¸ë¦¬ë³´ê¸° 1080Ã—1080 â€” PNG ì €ì¥ì„ ëˆ„ë¥´ë©´ íŒŒì¼ì´ ë‚´ë ¤ê°‘ë‹ˆë‹¤.";
}
$("#genBanner").addEventListener("click", drawBanner);
$("#saveBanner").addEventListener("click", ()=>{
  const a=document.createElement('a');
  a.download='banner.png';
  a.href=cv.toDataURL('image/png');
  a.click();
});
drawBanner();

// â”€â”€â”€ ìº¡ì…˜ ìƒì„± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const CAP = {
  friendly:[
    "ì˜¤ëŠ˜ë„ @{brand}! {offer} â˜•ï¸ #{tags}",
    "ì‹œí—˜ê¸°ê°„ì—” {product}! {reason} ğŸ”¥ #{tags}",
    "{offer} Â· ì§€ê¸ˆ {call}",
    "ì§‘ì¤‘ ëª¨ë“œ ON, {product}ë¡œ {benefit}! #{tags}",
    "íŒ”ë¡œìš°í•˜ê³  ì¿ í° ë°›ê¸° ğŸŸ #{tags}"
  ],
  minimal:[
    "{product}. {benefit}. #{tags}",
    "{offer}. {call}",
    "{brand} â€” {tagline}.",
    "{product}: {reason}",
    "ì˜¤ëŠ˜ë§Œ. #{tags}"
  ],
  energetic:[
    "{product} í­ë°œ ì„¸ì¼! {offer} âš¡ï¸ ì§€ê¸ˆ {call}",
    "ì˜¤ëŠ˜ ì•ˆ ì‚¬ë©´ ì†í•´â€¼ï¸ {offer} #{tags}",
    "ì—ë„ˆì§€ ì¶©ì „ ì™„ë£Œ. {product}ë¡œ {benefit}!",
    "ë‹¨ 24ì‹œê°„ {offer} ğŸ”¥",
    "DM ì—´ë ¤ìˆì–´ìš” â†’ {call}"
  ]
};
function pick(a){return a[Math.floor(Math.random()*a.length)]}
function hashTags(k){return k.split(',').map(s=>('#'+s.trim().replace(/\s+/g,''))).filter(Boolean).slice(0,5).join(' ')}
$("#genCaps").addEventListener("click", ()=>{
  const tone=$("#tone").value;
  const brand="BrandMate Cafe";
  const product="ì‹œê·¸ë‹ˆì²˜";
  const offer="í•™ìƒ 1,000ì›â†“";
  const reason="ë¡±í…€ ì¹´í˜ì¸ìœ¼ë¡œ ì˜¤ë˜ ê°€ìš”";
  const benefit="ì§‘ì¤‘ ìœ ì§€";
  const call="ë°©ë¬¸/ì„ ì£¼ë¬¸";
  const tags=hashTags($("#kw").value||"ì¹´í˜,í•™ìƒ,ì§‘ì¤‘,ì‹œí—˜,í• ì¸");
  const tagline="í•œ ì”ì˜ ì§‘ì¤‘ì„ ë‚´ì¼ë¡œ";
  const arr = Array.from({length:5}, (_,i)=>{
    return CAP[tone][i].replace(/{brand}/g,brand).replace(/{product}/g,product)
      .replace(/{offer}/g,offer).replace(/{reason}/g,reason).replace(/{benefit}/g,benefit)
      .replace(/{call}/g,call).replace(/{tags}/g,tags).replace(/{tagline}/g,tagline);
  });
  $("#capsOut").value = arr.join("\n\n");
});
$("#copyCaps").addEventListener("click", ()=>{ $("#capsOut").select(); document.execCommand('copy'); });

</script>
</body>
</html>
